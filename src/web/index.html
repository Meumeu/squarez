<!DOCTYPE html>
<html manifest="manifest.appcache">
	<head>
		<title>Squarez</title>
		<script src="script/squarez.js"></script>
		<script src="script/squarezUI.js"></script>
		<link rel="stylesheet" type="text/css" href="game.css">
		<link rel="stylesheet" type="text/css" href="gameSelection.css">
		<link rel="icon" type="image/png" href="img/icon30.png">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
	</head>
	<body>
		<div class="modeSelection">
			<a href="singleplayer.html" class="singleplayerChoice">
				<h1>1 player game</h1>
			</a>
			<a href="multiplayer.html" class="multiplayerChoice" id="multiplayerChoice" style="display:none">
				<h1>online game</h1>
				<div id="playerInfo">
					<span id="numPlayers"></span> players currently online
				</div>
			</a>
			<a href="tutorial.html" class="tutorialChoice">
				<h1>tutorial</h1>
			</a>
		</div>
		<div class="homeScoreList">
			<div id="highScores" style="display:none">
				<h1>High Scores</h1>
				<table>
					<tbody id="scoreList"></tbody>
				</table>
			</div>
		</div>
		<a id="install" style="display:none">Install the game</a>
		<script>
			var r = new XMLHttpRequest();
			r.open("get", "squarez/num_players");
			r.onreadystatechange = function()
			{
				if (r.readyState == 4 && r.status == 200)
					{
						players = r.responseText;

						if (players == 0)
							document.getElementById("playerInfo").style.display = "none";

						document.getElementById("numPlayers").innerHTML = players;
						document.getElementById("multiplayerChoice").style.display = "";
					}
			};
			r.send();

			if (window.navigator.mozApps)
			{
				var manifest = "http://" + window.location.host+ "/manifest.webapp";
				var appR = window.navigator.mozApps.checkInstalled(manifest);
				appR.onsuccess = function() {
					if (! appR.result)
					{
						var i = document.getElementById("install");
						i.style.display = "";
						i.onclick = function()
						{
							window.navigator.mozApps.install(manifest);
							i.style.display = "none";
						}
					}
				};
			}

			var scores = new Module.HighScores(0);
			var scoreVector = scores.scores;
			drawScoreList(scoreVector);
			scoreVector.delete();
			scores.delete();
		</script>
	</body>
</html>
